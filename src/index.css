@tailwind base;
@tailwind components;
@tailwind utilities;

/* =========================
   CORE BASE
   ========================= */
html, body {
  margin: 0;
  padding: 0;
}

/* Helpers */
.print-only { display: none !important; }

/* =========================
   PRINT PREVIEW MODE (SCREEN)
   ========================= */
html.print-preview,
body.print-preview {
  overflow: hidden !important;
}

html.print-preview #rapportino-document {
  position: fixed !important;
  top: 86px !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  width: min(1200px, calc(100vw - 24px)) !important;
  height: calc(100vh - 140px) !important;
  overflow: auto !important;
  z-index: 65 !important;
  background: #ffffff !important;
  color: #0b1220 !important;
  border: 1px solid rgba(148, 163, 184, 0.45) !important;
  border-radius: 14px !important;
  box-shadow: 0 30px 90px rgba(0,0,0,0.45) !important;
}

html.print-preview #rapportino-document .no-print { display: none !important; }
html.print-preview #rapportino-document .print-only { display: block !important; }

/* =========================
   PRINT (RÉEL)
   ========================= */
@media print {
  @page {
    size: A4 landscape;
    margin: 10mm;
  }

  html, body {
    background: #ffffff !important;
    color: #000000 !important;
    margin: 0 !important;
    padding: 0 !important;
    box-shadow: none !important;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  /* Nettoyage standard */
  .no-print { display: none !important; }
  .print-only { display: block !important; }

  /* =========================================================
     PRINT ISOLATION (ROBUSTE)
     - main.tsx déplace #rapportino-document sous <body> juste avant print
     - ici, on cache tout sauf #rapportino-document
     - pas de :has(), pas d'effet de bord, pas de page vide
     ========================================================= */
  html.core-printing body * {
    display: none !important;
  }

  html.core-printing body #rapportino-document,
  html.core-printing body #rapportino-document * {
    display: revert !important; /* conserve table/thead/tr/etc */
  }

  /* Neutralise tout effet preview (fixed/scale) pendant l'impression */
  html.core-printing #rapportino-document {
    position: static !important;
    top: auto !important;
    left: auto !important;
    transform: none !important;
    width: 100% !important;
    height: auto !important;
    overflow: visible !important;
    z-index: auto !important;
    border-radius: 0 !important;
    box-shadow: none !important;
    border: none !important;
    margin: 0 !important;
    padding: 0 !important;
    background: #ffffff !important;
    color: #000000 !important;
  }

  /* Wrapper document */
  #rapportino-document,
  .rapportino-document {
    width: 100% !important;
    max-width: none !important;
    margin: 0 !important;
    padding: 0 !important;
    background: #ffffff !important;
    color: #000000 !important;
    border: none !important;
    outline: none !important;
    box-shadow: none !important;
  }

  /* =========================
     FIX COLONNES (NOTE)
     ========================= */
  #rapportino-document .rapportino-table {
    width: 100% !important;
    table-layout: fixed !important;
  }

  #rapportino-document input,
  #rapportino-document textarea,
  #rapportino-document select {
    min-width: 0 !important;
  }

  #rapportino-document .rapportino-table th:nth-child(1),
  #rapportino-document .rapportino-table td:nth-child(1) { width: 25mm !important; }

  #rapportino-document .rapportino-table th:nth-child(2),
  #rapportino-document .rapportino-table td:nth-child(2) { width: 55mm !important; }

  #rapportino-document .rapportino-table th:nth-child(3),
  #rapportino-document .rapportino-table td:nth-child(3) { width: 50mm !important; }

  #rapportino-document .rapportino-table th:nth-child(4),
  #rapportino-document .rapportino-table td:nth-child(4) { width: 20mm !important; }

  #rapportino-document .rapportino-table th:nth-child(5),
  #rapportino-document .rapportino-table td:nth-child(5) { width: 18mm !important; }

  #rapportino-document .rapportino-table th:nth-child(6),
  #rapportino-document .rapportino-table td:nth-child(6) { width: 20mm !important; }

  #rapportino-document .rapportino-table th:nth-child(7),
  #rapportino-document .rapportino-table td:nth-child(7) { width: 55mm !important; }

  #rapportino-document .rapportino-table th:nth-child(8),
  #rapportino-document .rapportino-table td:nth-child(8) { width: 14mm !important; }

  #rapportino-document .rapportino-table th:nth-child(9),
  #rapportino-document .rapportino-table td:nth-child(9) {
    width: 0 !important;
    padding: 0 !important;
    border: none !important;
  }

  * {
    box-shadow: none !important;
    text-shadow: none !important;
  }
}

/* =========================
   RAPPORTINO DOCUMENT (SCREEN)
   ========================= */
#rapportino-document {
  background: #ffffff;
  color: #000000;
  width: 100%;
  margin: 0;
  padding: 0;
}

/* =========================
   TABLE RAPPORTINO
   ========================= */
.rapportino-table {
  width: 100%;
  border-collapse: collapse;
}

.rapportino-table th,
.rapportino-table td {
  border: 1px solid #cbd5e1;
  padding: 6px;
  vertical-align: top;
  font-size: 11px;
}

.rapportino-table th {
  font-weight: 600;
}

/* =========================
   SIGNATURE CORE (DISCRÈTE)
   ========================= */
.core-print-signature {
  position: fixed;
  bottom: 6mm;
  right: 8mm;
  font-size: 9px;
  color: rgba(0, 0, 0, 0.35);
  letter-spacing: 0.12em;
  user-select: none;
  pointer-events: none;
}

@media screen {
  .core-print-signature {
    color: rgba(0, 0, 0, 0.15);
  }
}
